' ** Script generated by Reporting Services Scripter 2.0.0.17 **
' ** Created by Jasper Smith (jas@sqldbatips.com)             **
' ** See http://www.sqldbatips.com for help/support           **
'
' Report Service : http://localhost/ReportServer/ReportService2005.asmx
' Item Name      : RPTDS
' Item Path      : /Reports/RPTDS
' Item Type      : DataSource
' Script Date    : 1/26/2013 12:49:48 PM
' Generated By   : RITCO\ECFY



Public Sub Main()
	Dim name As String = "RPTDS"
	Dim parent As String = "/Reports"

	'Common CatalogItem properties
	Dim descprop As New [Property]
	descprop.Name = "Description"
	descprop.Value = ""
	Dim hiddenprop As New [Property]
	hiddenprop.Name = "Hidden"
	hiddenprop.Value = "False"

	Dim props(1) As [Property]
	props(0) = descprop
	props(1) = hiddenprop


	Dim definition As New DataSourceDefinition
	definition.CredentialRetrieval = CredentialRetrievalEnum.Store
	definition.ConnectString = "Data Source=103.1.115.38;Initial Catalog=Ritco_Live;"
	definition.Enabled = True
	definition.EnabledSpecified = True
	definition.Extension = "SQL"
	definition.ImpersonateUser = False
	definition.ImpersonateUserSpecified = True
	definition.Prompt = "Enter a user name and password to access the data source:"
	definition.UserName = "sa"
	definition.Password = ""
	definition.WindowsCredentials = False
	definition.OriginalConnectStringExpressionBased = False
	definition.UseOriginalConnectString = False

	Try
		RS.CreateDataSource(name, parent,False, definition, props)
		Console.WriteLine("DataSource RPTDS created successfully")

		Console.WriteLine("You must supply the password using Report Manager to use this DataSource")

	Catch e As SoapException
		Console.WriteLine("Error : " + e.Detail.Item("ErrorCode").InnerText + " (" + e.Detail.Item("Message").InnerText + ")")
	End Try
End Sub
