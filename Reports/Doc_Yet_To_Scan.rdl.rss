' ** Script generated by Reporting Services Scripter 2.0.0.17 **
' ** Created by Jasper Smith (jas@sqldbatips.com)             **
' ** See http://www.sqldbatips.com for help/support           **
'
' Report Service : http://localhost/ReportServer/ReportService2005.asmx
' Item Name      : Doc_Yet_To_Scan
' Item Path      : /Reports/Doc_Yet_To_Scan
' Item Type      : Report
' Script Date    : 1/26/2013 12:49:32 PM
' Generated By   : RITCO\ECFY



Public Sub Main()
	Dim name As String = "Doc_Yet_To_Scan"
	Dim parent As String = "/Reports"
	Dim location As String = "Reports\Doc_Yet_To_Scan.rdl"
	Dim overwrite As Boolean = True
	Dim reportContents As Byte() = Nothing
	Dim warnings As Warning() = Nothing
	Dim fullpath As String = parent + "/" + name

	'Common CatalogItem properties
	Dim descprop As New [Property]
	descprop.Name = "Description"
	descprop.Value = ""
	Dim hiddenprop As New [Property]
	hiddenprop.Name = "Hidden"
	hiddenprop.Value = "False"

	Dim props(1) As [Property]
	props(0) = descprop
	props(1) = hiddenprop

	'Read RDL definition from disk
	Try
		Dim stream As FileStream = File.OpenRead(location)
		reportContents = New [Byte](stream.Length-1) {}
		stream.Read(reportContents, 0, CInt(stream.Length))
		stream.Close()

		warnings = RS.CreateReport(name, parent, overwrite, reportContents, props)

		If Not (warnings Is Nothing) Then
			Dim warning As Warning
			For Each warning In warnings
				Console.WriteLine(Warning.Message)
			Next warning
		Else
			Console.WriteLine("Report: {0} published successfully with no warnings", name)
		End If

		'Set report DataSource references
		Dim dataSources(0) As DataSource

		Dim definition0 As New DataSourceDefinition
		definition0.CredentialRetrieval = CredentialRetrievalEnum.Prompt
		definition0.ConnectString = "Data Source=124.153.77.48;Initial Catalog=TMS"
		definition0.Enabled = True
		definition0.EnabledSpecified = True
		definition0.Extension = "SQL"
		definition0.ImpersonateUser = False
		definition0.ImpersonateUserSpecified = True
		definition0.Prompt = ""
		definition0.WindowsCredentials = False
		definition0.OriginalConnectStringExpressionBased = False
		definition0.UseOriginalConnectString = True

		Dim ds0 As New DataSource
		ds0.Item = CType(definition0, DataSourceDefinitionOrReference)
		ds0.Name="TMS"
		dataSources(0) = ds0

		RS.SetItemDataSources(fullpath, dataSources)

		Console.Writeline("Report DataSources set successfully")



	Catch e As IOException
		Console.WriteLine(e.Message)
	Catch e As SoapException
		Console.WriteLine("Error : " + e.Detail.Item("ErrorCode").InnerText + " (" + e.Detail.Item("Message").InnerText + ")")
	End Try
End Sub

