' ** Script generated by Reporting Services Scripter 2.0.0.17 **
' ** Created by Jasper Smith (jas@sqldbatips.com)             **
' ** See http://www.sqldbatips.com for help/support           **
'
' Report Service : http://localhost/ReportServer/ReportService2005.asmx
' Item Name      : Reports
' Item Path      : /Reports
' Item Type      : Folder
' Script Date    : 1/26/2013 12:49:06 PM
' Generated By   : RITCO\ECFY



Public Sub Main()
	Dim name As String = "Reports"
	Dim parent As String = "/"
	Dim fullpath As String = parent + name

	'Common CatalogItem properties
	Dim descprop As New [Property]
	descprop.Name = "Description"
	descprop.Value = ""
	Dim hiddenprop As New [Property]
	hiddenprop.Name = "Hidden"
	hiddenprop.Value = "False"

	Dim props(1) As [Property]
	props(0) = descprop
	props(1) = hiddenprop

	Try
		RS.CreateFolder(name, parent, props)
		Console.WriteLine("Folder created: {0}", name)
	Catch e As SoapException
		If e.Detail.Item("ErrorCode").InnerText = "rsItemAlreadyExists" Then
			Console.WriteLine("Folder /Reports already exists and cannot be overwritten")
		Else
			Console.WriteLine("Error : " + e.Detail.Item("ErrorCode").InnerText + " (" + e.Detail.Item("Message").InnerText + ")")
		End If
	End Try
End Sub

