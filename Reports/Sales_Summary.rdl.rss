' ** Script generated by Reporting Services Scripter 2.0.0.17 **
' ** Created by Jasper Smith (jas@sqldbatips.com)             **
' ** See http://www.sqldbatips.com for help/support           **
'
' Report Service : http://localhost/ReportServer/ReportService2005.asmx
' Item Name      : Sales_Summary
' Item Path      : /Reports/Sales_Summary
' Item Type      : Report
' Script Date    : 1/26/2013 12:49:49 PM
' Generated By   : RITCO\ECFY



Public Sub Main()
	Dim name As String = "Sales_Summary"
	Dim parent As String = "/Reports"
	Dim location As String = "Reports\Sales_Summary.rdl"
	Dim overwrite As Boolean = True
	Dim reportContents As Byte() = Nothing
	Dim warnings As Warning() = Nothing
	Dim fullpath As String = parent + "/" + name

	'Common CatalogItem properties
	Dim descprop As New [Property]
	descprop.Name = "Description"
	descprop.Value = ""
	Dim hiddenprop As New [Property]
	hiddenprop.Name = "Hidden"
	hiddenprop.Value = "False"

	Dim props(1) As [Property]
	props(0) = descprop
	props(1) = hiddenprop

	'Read RDL definition from disk
	Try
		Dim stream As FileStream = File.OpenRead(location)
		reportContents = New [Byte](stream.Length-1) {}
		stream.Read(reportContents, 0, CInt(stream.Length))
		stream.Close()

		warnings = RS.CreateReport(name, parent, overwrite, reportContents, props)

		If Not (warnings Is Nothing) Then
			Dim warning As Warning
			For Each warning In warnings
				Console.WriteLine(Warning.Message)
			Next warning
		Else
			Console.WriteLine("Report: {0} published successfully with no warnings", name)
		End If

		'Set report DataSource references
		Dim dataSources(0) As DataSource

		Dim dsr0 As New DataSourceReference
		dsr0.Reference = "/Reports/RPTDS"
		Dim ds0 As New DataSource
		ds0.Item = CType(dsr0, DataSourceDefinitionOrReference)
		ds0.Name="RPTDS"
		dataSources(0) = ds0


		RS.SetItemDataSources(fullpath, dataSources)

		Console.Writeline("Report DataSources set successfully")



	Catch e As IOException
		Console.WriteLine(e.Message)
	Catch e As SoapException
		Console.WriteLine("Error : " + e.Detail.Item("ErrorCode").InnerText + " (" + e.Detail.Item("Message").InnerText + ")")
	End Try
End Sub

